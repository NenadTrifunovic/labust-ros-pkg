<launch>
  <include file="$(find labust_launchers)/launch/caddy/$(env ROBOT).machine" />
  <arg name="is_sim" value="$(optenv IS_SIM 1)" />     

  <group ns="pladypos">
  	<rosparam command="load" file="$(find snippets)/data/locations/$(env LOCATION).yaml" />
  	
  	<include file="$(find labust_launchers)/config/control/joy.xml"/>
  		
  	<!-- <group ns="navigation"> -->
  		<rosparam command="load" file="$(env MODEL)" />
  	  	<rosparam command="load" file="$(find labust_launchers)/config/pladypos/navparams.yaml" />
  	  	
  	  	<remap from="tauAch" to="/pladypos/tauAch" /> 
  	  	  		
  		<include file="$(find labust_launchers)/config/navigation/navigation2D.xml" />
  		<include file="$(find labust_launchers)/config/pladypos/imu_gps.xml" unless="$(arg is_sim)"/>
  	<!-- </group> -->
  	
  	<!-- <group ns="control"> -->
  		<rosparam command="load" file="$(env MODEL)" />
  		<rosparam command="load"
			file="$(find labust_launchers)/config/pladypos/velocity_control.yaml" />
		<rosparam command="load"
			file="$(find labust_launchers)/config/pladypos/dp_control.yaml" />
			
		<remap from="stateHat" to="/pladypos/stateHat" />
		<remap from="state" to="/pladypos/stateHat" /> 
  		
  		<include file="$(find labust_launchers)/config/control/control_all.xml" />
  		
  		<!-- The simple execution manager -->
  		<rosparam command="load" file="$(find labust_launchers)/config/pladypos/manager.yaml" />
  		<include file="$(find labust_launchers)/config/control/manager.xml" />
  	<!-- </group> -->
  	
  	<!-- <group ns="simulation" if="$(arg is_sim)"> -->
  	<group if="$(arg is_sim)">
  		<rosparam command="load" file="$(env MODEL)" />
  		<rosparam command="load" file="$(env ALLOCATION_MODEL)" />
  		
  		<remap from="fix" to="/pladypos/gps" />
  		<remap from="imu" to="/pladypos/imu" />
		<remap from="tauIn" to="/pladypos/tauOut" />
		<remap from="tauAch" to="/pladypos/tauAch" />
			
  		<include file="$(find labust_launchers)/config/simulator/simulator.xml" />
  	</group>
  	<!-- </group> -->
  	
  	<!-- logger apps -->
  	<group if="$(optenv ENABLE_LOGGING 0)">
  		<rosparam command="load" file="$(find pladypos)/data/pladypos_info_t.yaml" />
  		<rosparam command="load" file="$(find labust_imu)/data/imu_info_t.yaml" />
  		<rosparam command="load" file="$(find labust_control)/data/hldiagnostics_t.yaml" />
  		<rosparam command="load" file="$(find labust_launchers)/config/pladypos/logger.yaml" />
  		<include file="$(find matlogger)/launch/std_logger.launch" />
  	</group>  	
  </group>
</launch>
